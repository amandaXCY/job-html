const { globalObjectKey } = require('../constants.js');
const { postCSS } = global[globalObjectKey];
const cssLoader = require('./css-module-loader');
const extractCssConfig = require('./extract-css-conf');

const use = [
  extractCssConfig,
  cssLoader
];

if (postCSS) {
  use.push(require('./postcss-rule'));
}

use.push({
  loader: 'less-loader',
  options: {
    javascriptEnabled: true
  }
});

module.exports = {
  test: /\.less$/,
  use
};
